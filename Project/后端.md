[toc]

# 后端

## 一、缓存相关

### 1、缓存穿透

一般的缓存系统，都是按照key去缓存查询，如果不存在对应的value，就去后端系统查找。如果key对应的value是一定不存在的，并且对该key并发请求量很大，就会对后端系统造成很大的压力。这就是缓存穿透。

解决办法：

1. 对查询结果为空的情况也进行缓存，
2. 对一定不存在的key进行过滤。比如使用布隆过滤器

### 2、缓存雪崩

当缓存服务器重启或者大量缓存集中在某一个时间段失效，这样在失效的时候也会给后端系统带来很大压力。

解决办法：

1. 在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量，比如对某个key只允许一个线程查询数据和写缓存，其他线程等待。
2. 不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀。
3. 做二级缓存，A1为原始缓存，A2为拷贝缓存，可以访问A2，A1缓存失效时间设置为短期，A2设置为长期。
4. 使用熔断机制。当流量达到一定阈值，就返回系统繁忙等提示，防止过多请求打在数据库上。
5. 提高数据库的容灾能力，可以使用分库分表，读写分离的策略。

### 3、缓存击穿

一个热点的key，有大并发集中对其进行访问，突然间这个key失效了，导致大并发全部打在数据库上，导致数据库压力剧增。

解决办法：

1. 如果业务允许的话，对于热点的key可以设置永不过期的key
2. 使用锁机制。在缓存失效的情况下，只有拿到锁才可以查询数据库，降低了在同一时刻打在数据库上的请求。



## 二、数据库

1、不要联表查询

