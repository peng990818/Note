# 后端

## 一、缓存相关

### 1、缓存穿透

一般的缓存系统，都是按照key去缓存查询，如果不存在对应的value，就去后端系统查找。如果key对应的value是一定不存在的，并且对该key并发请求量很大，就会对后端系统造成很大的压力。这就是缓存穿透。

解决办法：

1. 对查询结果为空的情况也进行缓存，
2. 对一定不存在的key进行过滤。比如使用布隆过滤器

### 2、缓存雪崩

当缓存服务器重启或者大量缓存集中在某一个时间段失效，这样在失效的时候也会给后端系统带来很大压力。

解决办法：

1. 在缓存失效后，通过加锁或者队列来控制读数据库写缓存的线程数量，比如对某个key只允许一个线程查询数据和写缓存，其他线程等待。
2. 不同的key，设置不同的过期时间，让缓存失效的时间点尽量均匀。
3. 做二级缓存，A1为原始缓存，A2为拷贝缓存，可以访问A2，A1缓存失效时间设置为短期，A2设置为长期。
4. 使用熔断机制。当流量达到一定阈值，就返回系统繁忙等提示，防止过多请求打在数据库上。
5. 提高数据库的容灾能力，可以使用分库分表，读写分离的策略。

### 3、缓存击穿

一个热点的key，有大并发集中对其进行访问，突然间这个key失效了，导致大并发全部打在数据库上，导致数据库压力剧增。

解决办法：

1. 如果业务允许的话，对于热点的key可以设置永不过期的key
2. 使用锁机制。在缓存失效的情况下，只有拿到锁才可以查询数据库，降低了在同一时刻打在数据库上的请求。



## 二、数据库

1、不要联表查询



## 三、base64

一种将二进制数据编码为ASCII字符串格式的方法。常用于需要在只处理文本数据的媒介上存储和传输数据的场合，比如通过MIME发送的电子邮件，以及在XML或JSON中存储复杂数据。

Base64字符表包括大写字母A-Z、小写字母a-z、数字0-9，加号+和斜杠/。

工作原理

1. 输入数据：首先获取要编码的二进制数据。
2. 分组：将这些数据按每3个字节（24位）为一组进行处理。
3. 编码：每组数据再按每6位进行分组，这样每组可以映射到一个Base64字符表中的字符。
4. 填充：如果最后一组数据不足3个字节（24位），则在编码后的字符串末尾添加一个或两个等号（=）进行填充，以确保Base64编码字符串的长度是4的倍数。

优势：

- 传输安全：由于Base64编码后生成的字符串只包含ASCII字符，因此可以在电子邮件、URL、JSON等只处理文本的场景中安全传输。
- 避免数据损坏：有些传输协议或媒介可能不支持二进制数据，直接传输二进制数据可能会导致数据被截断或修改。Base64编码将二进制数据转为文本形式，有效避免这些问题。
- 兼容性好：Base64编码后的字符串可以在不同系统和平台之间无缝传输，无需担心字符编码的问题。
